# Privileged Account Inventory 

## Objective 
Create an initial inventory to detect blind spots and prioritise onboarding.

## Approach 
As an IAM Business Strategic Analyst, I led the privileged account inventory phase, ensuring comprehensive coverage to avoid blind spots.
I collaborated with AD administrators to extract data via PowerShell scripts, targeting accounts that were members of high-privilege groups (e.g., Domain Admins, Enterprise Admins). At the same time, I asked application owners for lists of critical resources, such as trading servers (Euroclear) and cloud instances (AWS RDS, Azure SQL). SQL scripts were used to cross-reference this data with HR information from Workday, identifying orphaned accounts or those not linked to an active EmployeeID. This multi-source approach (AD, Workday, owner lists) enabled comprehensive mapping.

### Data sources

- [AD users — CSV](../4_Documents%20&%20diagrams/ad_users.csv)
- [Membership in privileged groups](../4_Documents%20&%20diagrams/ad_priv_membership.csv)
- [HR roster](../4_Documents%20&%20diagrams/hr_employees.csv)

### Pipeline

1) Load CSV into a lightweight SQL database (`iam_phase0_demo.db`).  
2) Run reconciliation queries (AD ↔ HR) and privileged membership checks.  
3) Export results as evidence (CSV + screenshots from your SQL tool).


### PowerShell - Extraction
I wrote a PowerShell script that automatically retrieves all members of the five most critical groups in Active Directory, along with their last login and EmployeeID.
In two minutes, I extracted 850 high-privilege accounts → the perfect basis for reconciliation with Workday and detection of orphans.

![image_alt](https://github.com/Kristina-1991/IAM-Portfolio-CyberArk-ZeroTrust-Finclear-Final/blob/1edb6f9e84824cde4831c50397f6bf694d576bad/4_Documents%20%26%20diagrams/Powershell_script_Final.png?raw=true)

###  Results
The inventory revealed a total of **850 privileged accounts**, including **150 generic/orphaned accounts (18 %)** and 213 accounts not reviewed for more than six months **(25 %)**.

These findings directly justified the CyberArk programme:
- 18 % generic/orphan accounts → immediate need for ownership assignment and semi-automated onboarding (BR-01)
- 100 % of privileged accounts with permanent rights → introduction of JIT elevation (BR-02)
- Zero session monitoring on 850 accounts → mandatory PSM recording (BR-03)

| Risk Category                  | Accounts | %    | Target CyberArk Control       |
|--------------------------------|---------:|-----:|--------------------------------|
| Generic / Orphan accounts      | 150     | 18% | BR-01 – Ownership & Onboarding |
| Stale >6 months (high risk)    | 213     | 25% | BR-02 – JIT + dual approval    |
| No session monitoring          | 850     |100% | BR-03 – PSM recording + Splunk |
| **Total privileged accounts**  | **850** |     |                                |

### Next step
All 150 generic/orphan + 213 stale accounts have been prioritised in Wave 1 & 2 onboarding plan (see section 2_Onboarding_Waves_Scale).


Link: [Inventory_Sample_20](../4_Documents%20&%20diagrams/Inventory_Sample_20.csv)

Link: [out_generic_patterns](../4_Documents%20&%20diagrams/out_generic_patterns.csv)

Link: [out_orphans](../4_Documents%20&%20diagrams/out_orphans.csv)

Link: [out_high_risk_stale](../4_Documents%20&%20diagrams/out_high_risk_stale.csv)

## Tools 
- Powershell for the AD data extraction
- Sql
- The list of critical resources






