# JIT with Dual Approval Workflow Design (BR-02)

**Objective**  
Replace permanent elevated rights and manual e-mail approvals with a fully auditable dual-approval workflow enforcing strict separation of duties and granting temporary, just-enough, just-in-time access to targeted resources.

**My role** : I designed the workflow, wrote the business rules, and got it signed off by CISO + Head of Infrastructure.

**Key Design Decisions (validated in 2 workshops)**
| Rule                                 | Decision (Wave 1)                                 | Reason / Compliance |
|--------------------------------------|---------------------------------------------------|---------------------|
| Approval type                        | **Dual control** – Business Owner + Technical Owner | DORA Art.25 / NIS2 |
| Maximum session duration              | 8 hours (default 4 h)                              | Zero standing privilege |
| Mandatory justification               | Yes – free text + ticket reference (ticket/incident) | Audit trail |
| Escalation if no answer              | 30 min → auto-escalate to backup approver          | SLA operational |
| Automatic revocation                 | At expiry or manual “kill switch” by SOC          | Real-time risk reduction |

## Access request workflow - BPMN diagram AS IS  

Informal e-mail threads → no trace, no time limit → 0 % audited

![image_alt](https://github.com/Kristina-1991/IAM-Portfolio-CyberArk-ZeroTrust-Finclear-Final/blob/8736794400a45f772e1363f0265b90cc9e420d4a/4_Documents%20%26%20diagrams/Access_request_AS%20IS.PNG?raw=true)

*Figure 1 - Access request workflow - BPMN diagram AS IS*

--- 

### BPMN token simulation:

To try the interactive the BPMN simulation : 

1. Download the BPMN file : [JIT Dual_approval workflow BPMN diagram](../4_Documents%20&%20diagrams/Access_request_ASIS_JIT_Worflow.bpmn)
2. Open this simulator : https://bpmn-io.github.io/bpmn-js-token-simulation/modeler.html
3. Drag and drop the BPMN file
4. Click on "token simulation"
5. Click on the "trigger event" 

## JIT Approval workflow - BPMN diagram TO BE 

![image_alt](https://github.com/Kristina-1991/IAM-Portfolio-CyberArk-ZeroTrust-Finclear-Final/blob/dedc81ec035a7d2f0dfd87f2d89c344883add47e/4_Documents%20%26%20diagrams/JIT_%26_Dual_approval_workflow.PNG?raw=true)

*Figure n°1 - Dual approval workflow - BPMN diagram TO BE* 

### BPMN token simulation:

To try the interactive the BPMN simulation : 

1. Download the BPMN file : [JIT Dual_approval workflow BPMN diagram](../4_Documents%20&%20diagrams/Dual_approval_workflow_TO_BE.bpmn)
2. Open this simulator : https://bpmn-io.github.io/bpmn-js-token-simulation/modeler.html
3. Drag and drop the BPMN file
4. Click on "token simulation"
5. Click on the "trigger event" 


## Dual Approval workflow - implementation in CyberArk

### 1. Master Policy configuration (Security Administrator)
This step enforces the Dual Control requirement for critical accounts.
- Enable: **Dual control password access approval**
- Configure approvers (Level 2 Confirmer) via Safe members
- Mapping to ownership matrix (Business Owner + Technical Owner)

### Screenshots

First, The Security Administrator must activate the dual control option. 

![image_alt]( https://github.com/Kristina-1991/IAM-Portfolio-CyberArk-ZeroTrust-Finclear-Final/blob/f3b2d571eed02f9f10aa119ed96cbd5644df7938/4_Documents%20%26%20diagrams/Configuration_1.png?raw=true) 

*Figure 1 - Master Policy configuration (Security Administrator) – Dual Control rule*

---

The Security administrator must configure options in the Master Policy for the safe related to the critical server. 
He must selected the following tab : 
- Policies
- Master Policy
- and Safe 

![image_alt]( https://github.com/Kristina-1991/IAM-Portfolio-CyberArk-ZeroTrust-Finclear-Final/blob/f3b2d571eed02f9f10aa119ed96cbd5644df7938/4_Documents%20%26%20diagrams/Configuration_2.png?raw=true)

*Figure 2 - Master Policy configuration (Security Administrator) -  Safe's selection*

---

Then the Security administrator must attribute an approver to the targeted Safe by clicking on **"Add member"**.

![imge_alt]( https://github.com/Kristina-1991/IAM-Portfolio-CyberArk-ZeroTrust-Finclear-Final/blob/f3b2d571eed02f9f10aa119ed96cbd5644df7938/4_Documents%20%26%20diagrams/Configuration_3.png?raw=true) 

*Figure 3 - Master Policy configuration (Security Administrator) - Safe's attribution to an approver*

---

Then the Security Administrator must select the approver after searching the approver. 

![image_alt]( https://github.com/Kristina-1991/IAM-Portfolio-CyberArk-ZeroTrust-Finclear-Final/blob/f3b2d571eed02f9f10aa119ed96cbd5644df7938/4_Documents%20%26%20diagrams/Configuration_4.png?raw=true) 

*Figure 4 - Safe configuration (Security Administrator) - Selection of an approver* 

---

Then, the Security Administrator must select the "List accounts" option. 


![image_alt](https://github.com/Kristina-1991/IAM-Portfolio-CyberArk-ZeroTrust-Finclear-Final/blob/f3b2d571eed02f9f10aa119ed96cbd5644df7938/4_Documents%20%26%20diagrams/Configuration_5.png?raw=true)

*Figure 5 - Safe configuration (Security Administrator) - view list accounts*

---


In this step, the Security Administrator scrolls down and on the selected "Workflow" functionality, he must select the option "Level 2 confirmer" to ensure the dual approval.
Then, click on "Add". 

![image_alt]( https://github.com/Kristina-1991/IAM-Portfolio-CyberArk-ZeroTrust-Finclear-Final/blob/f3b2d571eed02f9f10aa119ed96cbd5644df7938/4_Documents%20%26%20diagrams/Configuration_6.png?raw=true) 

*Figure 6 - Safe configuration (Security Administrator) - Level 2 confirmer*

---

Finally, the Security Administrator can see that the approver "Mike" has been added to the list of approvers related to the Windows server (Win-srv-Fra). 

![image_alt]( https://github.com/Kristina-1991/IAM-Portfolio-CyberArk-ZeroTrust-Finclear-Final/blob/f3b2d571eed02f9f10aa119ed96cbd5644df7938/4_Documents%20%26%20diagrams/Configuration_7.png?raw=true) 

*Figure 7 - Safe configuration (Security Administrator) Final view*

---

### 2. Platform configuration (Security Administrator)
The Security Administrator configures the platform associated with the account to enable Just-In-Time access via the CyberArk settings tree:

- First, he must go to **Platform Management** and select the target platform.
- Secondly, he must click on **Edit** to open the configuration tree.
- Then, he navigates to UI & Workflows → **Privileged Session Management**.
- He must enable the Checkout Duration options to enforce a maximum temporary access duration (JIT).
- And finally save the configuration so that all access requests are automatically limited to the duration defined by the security team.

![image_alt]( https://github.com/Kristina-1991/IAM-Portfolio-CyberArk-ZeroTrust-Finclear-Final/blob/d05da6b0c393e3779a3e915dd5c63d5c3127c4d7/4_Documents%20%26%20diagrams/Platform_configuration_1.png?raw=true)

*Figure 1 - Platform configuration (Security Administrator) - JIT configuration*

---

## Dual approval workflow - application 
### 3. Access Request (Requester)
Users must request access through the PVWA.
- Click Request Connection
- Provide mandatory Justification
  
## Screenshots 

The user must click on the "Request connection" button.

![image_alt]( https://github.com/Kristina-1991/IAM-Portfolio-CyberArk-ZeroTrust-Finclear-Final/blob/27c9747e03831d8a9f5bda0718f0f4b14202c56e/4_Documents%20%26%20diagrams/Request_sub_1.png?raw=true) 

*Figure 1 - Access Request (Requester) - PVWA view*

---

Then, the user must fill the access request form with a justification. 

![image_alt]( https://github.com/Kristina-1991/IAM-Portfolio-CyberArk-ZeroTrust-Finclear-Final/blob/27c9747e03831d8a9f5bda0718f0f4b14202c56e/4_Documents%20%26%20diagrams/Resquest_sub_2.png?raw=true) 

*Figure 2 - Access Request (Requester) - Justification*

---

### 4. Approval workflow (Approver)
Approvers reviews and validates incoming requests.
- Navigate to Incoming Requests
- Click Confirm
- Validate request in the confirmation popup

## Screenshots

First, the approver must click on the "Incoming request" tab. 

![image_alt]( https://github.com/Kristina-1991/IAM-Portfolio-CyberArk-ZeroTrust-Finclear-Final/blob/b5145d224e5360a88e5b64fd06dccb00834ca0b7/4_Documents%20%26%20diagrams/Validation_Approver_1.png?raw=true) 


*Figure 1 - Approval workflow (Approver) - Incoming request* 

---

Secondly, he must review the request.

![image_alt]( https://github.com/Kristina-1991/IAM-Portfolio-CyberArk-ZeroTrust-Finclear-Final/blob/b5145d224e5360a88e5b64fd06dccb00834ca0b7/4_Documents%20%26%20diagrams/Validation_Approver_2.png?raw=true)

*Figure 2 - Approval workflow (Approver) - Review request* 

---
Then, he can approve the request by clicking on the "Confirm" button.

![image_alt]( https://github.com/Kristina-1991/IAM-Portfolio-CyberArk-ZeroTrust-Finclear-Final/blob/b5145d224e5360a88e5b64fd06dccb00834ca0b7/4_Documents%20%26%20diagrams/Validation_approver_3.PNG?raw=true)

*Figure 3 - Approval workflow (Approver) - Confirm request* 

---

Finally, he must justify the reason of the approbation. 

![image_alt]( https://github.com/Kristina-1991/IAM-Portfolio-CyberArk-ZeroTrust-Finclear-Final/blob/b5145d224e5360a88e5b64fd06dccb00834ca0b7/4_Documents%20%26%20diagrams/Validation_Appover_4.png?raw=true) 

*Figure 4 - Approval workflow (Approver) - Specify a reason* 

---
  
### 5. Privileged Access Session (Requester) 
Once approved, the user can access the critical resource.
- Click Connect in PVWA
- Provide reason (session logged for audit/SIEM)

---
## Screenshots

After receiving an notification's email, the user can click on the "Connect" button. 

![image_alt]( https://github.com/Kristina-1991/IAM-Portfolio-CyberArk-ZeroTrust-Finclear-Final/blob/d9a2bcc9a3d44540c8a8b9e37e5cfe4b59fbbbc2/4_Documents%20%26%20diagrams/End_User_Access_1.png?raw=true) 

*Figure 1 - Privileged Access Session (Requester) - PVWA view*

---

He also must add a reason for audit compliance. 

![image_alt]( https://github.com/Kristina-1991/IAM-Portfolio-CyberArk-ZeroTrust-Finclear-Final/blob/d9a2bcc9a3d44540c8a8b9e37e5cfe4b59fbbbc2/4_Documents%20%26%20diagrams/End_User_Access_2.png?raw=true)

*Figure 2 - Privileged Access Session (Requester) - Specify a reason* 

---

## Result Wave 1 

- 93 % of privileged sessions via JIT  
- Average approval time: 11 min  
- Zero permanent admin rights remaining





































