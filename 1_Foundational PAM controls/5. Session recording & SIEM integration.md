# Session Recording & SIEM Integration (BR-03)

**Objective**  
100 % of privileged sessions are isolated via PSM, recorded, encrypted and exported to Splunk in real time — zero direct access allowed.

**My role** : I defined the technical and compliance requirements, validated the integration, and wrote the runbooks.

**Design Decisions**
| Requirement                            | Implementation (Wave 1)                              | Compliance Mapping |
|----------------------------------------|-------------------------------------------------------|--------------------|
| Session isolation                          | All connections via PSM/PSM-SSH/HTML5 – direct blocked | ISO 27001 A.8.18   |
| Recording start                        | From the first keystroke (red dot visible)            | DORA Art.25        |
| Storage                                | Encrypted in CyberArk Vault – retention 1 year         | GDPR Art.32        |
| Real-time export                       | Syslog + HTTPS API → Splunk Enterprise Security       | NIS2 Art.21        |
| Searchability                          | Full-text + metadata search in PVWA < 5 min           | Audit readiness    |
| Live monitoring                        | SOC can view or terminate sessions in real time        | Incident response  |

## BPMN diagram AS IS   → 0 % recorded → no evidence for auditors


### BPMN token simulation:

To try the interactive the BPMN simulation : 

1. Download the BPMN file : [Access request AS IS ](../4_Documents%20&%20diagrams/)
2. Open this simulator : https://bpmn-io.github.io/bpmn-js-token-simulation/modeler.html
3. Drag and drop the BPMN file
4. Click on "token simulation"
5. Click on the "trigger event" 

## BPMN diagram TO BE 




### BPMN token simulation:

To try the interactive the BPMN simulation : 

1. Download the BPMN file : [Access request AS IS ](../4_Documents%20&%20diagrams/)
2. Open this simulator : https://bpmn-io.github.io/bpmn-js-token-simulation/modeler.html
3. Drag and drop the BPMN file
4. Click on "token simulation"
5. Click on the "trigger event"



### Splunk integration details
- Syslog forwarder on PSM servers  
- Parsing rules for fields: user, target, request_id, start/stop time  
- Dashboard live with KPIs

## Result Wave 1
- 100 % sessions recorded and searchable  
- Average search time: 4.2 seconds  
- Zero session without recording (blocked by policy)






