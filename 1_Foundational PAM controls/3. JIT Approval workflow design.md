# JIT Approval Workflow Design (BR-02)

**Objective**  
Replace permanent elevated rights and manual e-mail approvals with a fully auditable dual-approval workflow enforcing strict separation of duties and granting temporary, just-enough, just-in-time access to high-critical resources.

**My role** : I designed the workflow, wrote the business rules, and got it signed off by CISO + Head of Infrastructure.

**Key Design Decisions (validated in 2 workshops)**
| Rule                                 | Decision (Wave 1)                                 | Reason / Compliance |
|--------------------------------------|---------------------------------------------------|---------------------|
| Approval type                        | **Dual control** – Business Owner + Technical Owner | DORA Art.25 / NIS2 |
| Maximum session duration              | 8 hours (default 4 h)                              | Zero standing privilege |
| Mandatory justification               | Yes – free text + ticket reference (ticket/incident) | Audit trail |
| Escalation if no answer              | 30 min → auto-escalate to backup approver          | SLA operational |
| Automatic revocation                 | At expiry or manual “kill switch” by SOC          | Real-time risk reduction |

## JIT Approval workflo - BPMN diagram AS IS  
**AS IS (before)** → Informal e-mail threads → no trace, no time limit → 0 % audited

## JIT Approval workflow - BPMN diagram TO BE 

![image_alt](https://github.com/Kristina-1991/IAM-Portfolio-CyberArk-ZeroTrust-Finclear-Final/blob/39c1bd1dec03c49a8e0354c3e35413b9a11f6e19/4_Documents%20%26%20diagrams/Dual_approval_workflow.PNG?raw=true)

*Figure n°1 - Dual approval workflow - BPMN diagram TO BE* 

### BPMN token simulation:

To try the interactive the BPMN simulation : 

1. Download the BPMN file : [JIT Dual_approval workflow BPMN diagram](../4_Documents%20&%20diagrams/Dual_approval_workflow_TO_BE.bpmn)
2. Open this simulator : https://bpmn-io.github.io/bpmn-js-token-simulation/modeler.html
3. Drag and drop the BPMN file
4. Click on "token simulation"
5. Click on the "trigger event" 


## Dual Approval workflow - implementation in CyberArk

### 1. Master Policy configuration (Security Administrator)
This step enforces the Dual Control requirement for critical accounts.
- Enable: **Dual control password access approval**
- Configure approvers (Level 2 Confirmer) via Safe members
- Mapping to ownership matrix (Business Owner + Technical Owner)

### Screenshots

![image_alt](https://github.com/Kristina-1991/IAM-Portfolio-CyberArk-ZeroTrust-Finclear-Final/blob/249f36f4d2bd7db6931eb34ba564d55ced8ca1bd/4_Documents%20%26%20diagrams/Configuration_1.PNG?raw=true)

*Figure 1 - Master Policy configuration (Security Administrator) – Dual Control rule*

![image_alt]( https://github.com/Kristina-1991/IAM-Portfolio-CyberArk-ZeroTrust-Finclear-Final/blob/249f36f4d2bd7db6931eb34ba564d55ced8ca1bd/4_Documents%20%26%20diagrams/Configuration_2.PNG?raw=true)

*Figure 2 - Master Policy configuration (Security Administrator) -  Safe's selection*


![image_alt]( https://github.com/Kristina-1991/IAM-Portfolio-CyberArk-ZeroTrust-Finclear-Final/blob/249f36f4d2bd7db6931eb34ba564d55ced8ca1bd/4_Documents%20%26%20diagrams/Configuration_3.PNG?raw=true)

*Figure 3 - Master Policy configuration (Security Administrator) - Safe's attribution to an approver*


![image_alt]( https://github.com/Kristina-1991/IAM-Portfolio-CyberArk-ZeroTrust-Finclear-Final/blob/cf8d307076d80eb638a2529a13a3b3adac49cc7f/4_Documents%20%26%20diagrams/Configuration_4.PNG?raw=true)

*Figure 4 - Master Policy configuration (Security Administrator) - Add Level 2 confirmer* 



### 2. Platform configuration (Security Administrator)
The Security Admin configures the platform associated with the account to enable Just-In-Time access via the CyberArk settings tree:

- Go to Platform Management and select the target platform.
- Click Edit to open the configuration tree.
- Navigate to UI & Workflows → Privileged Session Management.
- Enable the Checkout Duration options to enforce a maximum temporary access duration (JIT).
- Save the configuration so that all access requests are automatically limited to the duration defined by the security team.

![image_alt](https://github.com/Kristina-1991/IAM-Portfolio-CyberArk-ZeroTrust-Finclear-Final/blob/19d780593c60df400b8e68a36d762cc18fe71ead/4_Documents%20%26%20diagrams/Platform_configuration.png?raw=true)


### 3. Access Request (Requester)
Users must request access through the PVWA.
- Click Request Connection
- Provide mandatory Justification
  
## Screenshot 

![image_alt](https://github.com/Kristina-1991/IAM-Portfolio-CyberArk-ZeroTrust-Finclear-Final/blob/53e1bf22fd9d61566af6a01b7d02d673861c7b88/4_Documents%20%26%20diagrams/Request_submission_1.PNG?raw=true)

*Figure 1 - Access Request (Requester) - PVWA view*


![image_alt]( https://github.com/Kristina-1991/IAM-Portfolio-CyberArk-ZeroTrust-Finclear-Final/blob/53e1bf22fd9d61566af6a01b7d02d673861c7b88/4_Documents%20%26%20diagrams/Request_submission_2.PNG?raw=true)

*Figure 2 - Access Request (Requester) - Justification*



### 4. Approval workflow (Approver)
Approvers review and validate incoming requests.
- Navigate to Incoming Requests
- Click Confirm
- Validate request in the confirmation popup

**Screenshots**

![image_alt]( https://github.com/Kristina-1991/IAM-Portfolio-CyberArk-ZeroTrust-Finclear-Final/blob/656b25247d063ed2277f3b937713130f2a5d7202/4_Documents%20%26%20diagrams/Validation_approver_1.PNG?raw=true) 

*Figure 1 - Approval workflow (Approver) - Incoming request* 


![image_alt]( https://github.com/Kristina-1991/IAM-Portfolio-CyberArk-ZeroTrust-Finclear-Final/blob/656b25247d063ed2277f3b937713130f2a5d7202/4_Documents%20%26%20diagrams/Validation_approver_2.PNG?raw=true) 

*Figure 2 - Approval workflow (Approver) - Review request* 


![image_alt]( https://github.com/Kristina-1991/IAM-Portfolio-CyberArk-ZeroTrust-Finclear-Final/blob/656b25247d063ed2277f3b937713130f2a5d7202/4_Documents%20%26%20diagrams/Validation_approver_3.PNG?raw=true) 

*Figure 3 - Approval workflow (Approver) - Confirm request* 


![image_alt](https://github.com/Kristina-1991/IAM-Portfolio-CyberArk-ZeroTrust-Finclear-Final/blob/656b25247d063ed2277f3b937713130f2a5d7202/4_Documents%20%26%20diagrams/Validation_approver_4.PNG?raw=true)

*Figure 4 - Approval workflow (Approver) - Specify a reason* 

  
### 5. Privileged Access Session (Requester) 
Once approved, the user can access the critical resource.
- Click Connect in PVWA
- Provide reason (session logged for audit/SIEM)

## Screenshots
![image_alt]( https://github.com/Kristina-1991/IAM-Portfolio-CyberArk-ZeroTrust-Finclear-Final/blob/666de6ceaf1b5b9b4cd237c5eb70da3477c98a77/4_Documents%20%26%20diagrams/Access_End-user_1.PNG?raw=true) 

*Figure 1 - Privileged Access Session (Requester) - PVWA view*

![image_alt]( https://github.com/Kristina-1991/IAM-Portfolio-CyberArk-ZeroTrust-Finclear-Final/blob/666de6ceaf1b5b9b4cd237c5eb70da3477c98a77/4_Documents%20%26%20diagrams/Access_End-user_2.PNG?raw=true)

*Figure 2 - Privileged Access Session (Requester) - Specify a reason* 


## Result Wave 1 

- 93 % of privileged sessions via JIT  
- Average approval time: 11 min  
- Zero permanent admin rights remaining

























